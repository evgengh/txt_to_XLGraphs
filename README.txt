txt_to_XLgraphs version 10.6
============================

ЧТО НОВОГО?

---------------

Версия 10.6 собрана для Linux (64bit):
 Т.е. должна запускаться по sh без каких-либо доп. библиотек для python.
 !!!Если запускать из исходников, нужно выполнить python txt_to_XLgraphs.py, 
 а также должна быть установлена библиотека xlsxwriter для python.
 
 Существенно доработан функционал поиска файла,
оказывается, tkinter предполагает добавление назнаний узлов дерева ФС
в столбец с деревом, а не только со свойствами. Добавлен столюец с размером файла
и коммент , если он не читается алгоритмом.
 Генерируется в формате otc, для среднего и медианы нули убираются пересчетом формул,
есть пояснения в листе Данных.
 Некоторые доработки с исключениями.
 Ну и ОСНОВНОЕ - отклеилась картинка с лицензией, теперь там больше про формат.

Версия 10.4 собрана на данный момент под Win32:
- Добавлено Среднее значение и значение Медианы для столбцов
Если в выгруженном файле все средние значения отображаются нулями,
необходимо сохранить КАК документ в ODS-формате  (экспортировать) и переоткрыть полученый документ.
- Дополнено докумнтация (см. 'работа с приложением', абзац 'Важно!')
- Некорректно определялся формат файла, брался стандартный формат (второй в примере)
для всех файлов, хотя первый соответствовал
- Генерируемые файлы теперь в формате sxc, otc - все же из OpenDocument.
----------------
- Генерируемые файлы теперь в формате otc.
- Добавлено ограничение на попытке перейти на один уровень выше в дереве файловой системы,
находя в корне диска (в директории /).
- Исправлена ошибка, точнее сказать, особенность, которая блокировала аналитику,
если предварительно осуществлялась навигация по дереву (вверх).
- Небольшие исправления/доработки по интерфейсу и т.д.
---------------

- Исправлен механизм проверки файлов по регуляркам - раньше была жесткая 
проверка по ключу.
- Добавлена строгая проверка, что файлы соответствуют формату csv, tsv.
- Добавлены некоторые внутренние флажки - на будущее.
Возможно, из стастистики без столбца времени можно тоже что-то сделать.
- Из-за того, что простая регулярка может пожирать большое число структур
желательно более детальные регулярки указывать вверху 
(примеры в structure_patterns.txt)

--Не удалось побороть увеличенные размеры окон при переходах между разделами.
--Планируются  некоторые доработки с возможностью не зависить от времени.

ВНИМАНИЕ!

Перед работой с программой желательно ознакомиться с содержанием 
данного файла полностью, он неочень большой.
И ОБЯЗАТЕЛЬНО (!!!) с разделом "ОСОБЕННОСТИ" - он содержит информацию
о форматах дат, времени, десятичных разделителей и т.д.
Также просьба не радактировать данный файл, поксольку он загружается
в раздел помощи программы.
Также, желательно, не менять раздел ОСОБЕННОСТИ (масштабируемость) (!!!) -
не в нем удалять пункты с "(!!!)", приложение не запустится из-за проверок.
Там можно добавлять/дополнять их.

ФАЙЛЫ
----------------------------
Программа представляет собой исполняемый файл txt_to_XLgraphs.exe,
файл подкачки регулярных выражений structure_patterns.txt, а также
файлы страниц информации и помощи и файлы и папки, сгенерированные
при создании программы. При их отстутсвии приложение может не работать
или работать некорректно.

УСТАНОВКА
----------------------------
Программа не требует установки, а также установки каких-либо специальных
приложений. Достаточно запустить исполняемы файл txt_to_XLgraphs.exe в корневой
папке программы.

РАБОТА С ПРИЛОЖЕНИЕМ
----------------------------
Для работы с приложением необходимо, чтобы хотя бы одно регулярное выражение
было указано в файле structure_patterns.txt. При необходимости можно добавлять 
регулярные выражения в данном файле, используя определнный формат. По-умолчанию
файл содержит одно регулярное выражение и файл (формат .txt) статитстики в папке examples,
формат которого регулярное выражение проверяет.
Для уверенности, что файл обработается корретно см. раздел "ОГРАНИЧЕНИЯ"
данного документа.
Важно! Если регулярные выражения охватывают несколько предполагаемых форматов,
стоит добавлять pattern в порядке от более определенного к более общему, 
например <Столбец1[,\s]+Столбец2[,\s]> .. <.*?>. Таким образом, формат 
с более высоким приоритетом (распологаемый выше) будет тестироваться раньше, 
более общий формат будет тестироваться только в том случае, если не подошел не один из 
предыдущих.
   
   Структура файла:
                    # Поле комментария - при подгрузке файла игнорируется
                    key: ключ формата документа, желательно использовать
                         английскую раскладку и неочень длинные названия,
                         формат key:<ключ>.
                         В интерфейсе не отображается.
                    name: Название формата документа, можно использовать
                          русскую раскладку и адекватные символы, используется
                          для отображения в интерфейсе найденного формата, а
                          также для сохранения конечного файла.
                          формат name:<название>.
                    pattern: регулярное выражение для проверки загружаемого формата
                             файла. Заполняется также как и обычное регулярное
                             выражение. Перед заполнением само выражение
                             можно отладить в редакторе (на примере статистики)
                             поддержавающем рег. выражения (напр. Notepad++).
                             формат pattern:<regular_start>выражен.<regular_end>

Программа поддерживает файловый браузер, 
но функционал не позволяет выходить за пределы одного диска(!!!),
например если запускается с диска D:, то и файл статистики должен 
находится на этом логическом диске, а также полученный файл с графиками (выходной)
будет сохранен на этом диске в папку, верхнюю после поиска нужного файла.
Т.е. если при поиске файла браузер дошел до корня D: то выходной
файл запишется в корень (!!!) с названием из name: и расширением .ods(!!!) (открытый формат 
для электронных таблиц, возможно изменения расширения на .xlsx позволит открывать документ в Excel,
также, возможно, что это даже законно:)).

ИНТЕРФЕЙС ПРИЛОЖЕНИЯ
----------------------------
Программа содержит нескольно основных модулей работы с приложением:
    1. Главное окно программы - просто немного информации из Wiki
    2. Страницы помощи и информации об авторе и программе, а также лицензия
    3. Поиск файла - древовидная структура файловой система внутри одного диска
    4. Предварительный просмотр файла
    5. Панель доступных операций для данного файла
    6. Панель работы с интересующим временным интервалом

Элементы интерфейса программы:
------------              |-------***------|
| Искать_* |------------->| Выбор файла    |<-----
------------      ^       |----------------|     |
                  |               |              |<--|
                  |             Файл выбран      |   |
                  |               v--------------|   |     ------------
-------------     |       |--------***--------|      |     | Подходит? |----|
|Завершить& |     |       | Просмотр файла    |      |     ------------     |
-------------     |       |-------------------|      |           ^          |
      |           |               |                  |           |          |
      |           |               |------------------|           |          |
      v           |               v                  |------\\\\\\\\\\\     |
   ВЫХОД          |         --------------                  |          |    |
                  |         | Работать-->|----------------->| Панель   |    |
                  |         --------------                  |доступных |    |
                Выбрать                                     |операций  |    |
                другой                                      \\\\\\\\\\\     |
                 файл                                                       |
                  |---------------------------------------------------------|
                             ^   |
                             |   v
                          ---------------
                          |Разобраться=>|
                          ---------------
                                |
                        Формат определен
                                |
      --------------------------------------------------
      |                                                 |
      v-------------------------|                       v
-------------                   |                --------------
|В таблицу::|                   |                |Разобраться=>|
-------------                   |                ---------------
      |                         |                      |
      |                         |                      |
--------------                  |                 \\\\\\\\\\\\\
|Все пункты-^|                  |                 | Панель     |
--------------                  |<----------------| указания   |
      |                         |                 | интерес.   |
   Графики                      |                 | периода    |
  построены                     |                 \\\\\\\\\\\\\
  сохранение                    |                       |
    файла                       |                  Уточнения
      |                         |                       |
      |                         |                 ---------------
      |                         ------------------|Указать(-*<))|
    -----                                         ---------------
 

Алгоритм работы программы:
1. Элементы операций работы с файлом доступны только после его выбора
2. При необходимости можно выбрать другой файл, при этом обновятся панель операций и подсказок.
3. Если действие не может быть выполнено на текущем этапе работы с файлом,
то соответствующая кнопка становится недоступной.

ОСОБЕННОСТИ (масштабируемость)
----------------------------
Программа работает почти с любым типом файлов, которые открываются текстовым редактором,
либо определяет тип как необычный формат и не позволяет выполнять операции с таким типов.
Программа строит графики по первому столбцу(!!!) - горизонтальная ось времени всегда(!!!),
зависимость от времени - следующий столбец(!!!).
Соответственно количество графиков = число столбцов - 1 столбец времени + возможный столбец интервала,
если было указан интересующий период на графиках(!!!) - его график можно удалить вручную.
ВНИМАНИЕ! Разделители столбцов в файле - стандартная запятая (если это csv) 
и данные столбцов в кавычках, либо табуляция(!!!).
Десятичная точка как "." (!!!)
Формат даты и времени - dd(\/-)mm(\/-)yyyy, 24-часовой формат в виде hh:mm:ss.msc(!!!)
Формат даты можно предварительно изменить в самом Excel, если в файле не 24-часовой форматю
Программа отбрасывает значение даты при вставку данных в таблицу и построении графиков(!!!)
Также программа обрабатывает статистику в рамках одних суток(!!!), соотвтетственно, если
загружаются данные с переходом через 00:00:00 (!!!) программа автоматически хранит(генерирует) дату,
чтобы утренние данные были позднее вечерних.

1. Данная программа расчитана на работу только внутри одного логического диска в ОС Windows.
2. Вообще можно запускать программу с флеш-диска, скопировав туда файл статистики.
3. Парсинг файлов на определение формата расчитан на то, что проверяется наличие столбцов
времени(!!!) - первый столбец, данные - остальные столбцы (число!!!)
По этому принципу нужно прописывать регулярное выражение.

Вообще, программа загрузит любое регулярное выражение, но поведение ее непредсказуемо
при попытке загрузить такой файл в таблицу.

Ошибки в программе обработаны в основном при загрузке файлов приложения (README, 
structure-patterns и т.д.) и при загрузки регулярноых выражений - 
тут программа наиболее подробно сообщает о несоответствиях в файле регулярных выражений,
ошибках их компиляции (стандартные сообщения интерпретатора с указанием самого выражения).

ОГРАНИЧЕНИЯ
----------------------------
Программа не рассчитана на работу с произвольными форматом данных и файлов - 
т.е. разделители, десятичные точки и т.д. должны соответствовать описанных в разделе ОСОБЕННОСТИ
Также программа будет работать некорректно, если первый столбец не определяется как дата и время(!!!).

ЛИЦЕНЗИЯ
----------------------------
Copyright (c) 2017 Евгений Лобов

Авторские права и интеллектуальная собственность защищены лицензией GNU General Public License (GPL). 
См. каталог /license, а также раздел "Лицензия" в разделе информация.